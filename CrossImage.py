import matplotlib.pyplot as plt
from Tool import normal, find_road_edges_diff
from Get_CCD import read_ccd_data, find_road_edges
cross1 = [
[789,803,817,601,252,241,249,268,299,377,476,572,651,736,812,819,800,753,683,605,516,458,408,381,384,363,364,356,362,349,356,322,331,396,486,541,553,662,694,665,694,683,683,621,534,489,629,978,1137,985,1108,1187,1409,1348,1531,1837,1609,694,579,693,732,759,1021,864,758,748,693,588,534,449,389,418,387,313,326,354,323,421,386,326,309,336,315,313,336,330,403,493,486,387,321,276,275,376,532,630,749,1116,1702,2312,2858,3429,3267,3037,2898,2774,2729,2665,1306,397,364,340,326,304,297,288,279,269,268,114,115,115,115,107,145,168,171,177],
[193,198,206,202,201,204,220,214,209,213,226,226,235,223,236,240,243,235,243,237,242,243,249,245,247,242,248,241,257,250,262,251,259,260,262,255,267,269,273,279,283,265,285,288,294,291,297,277,252,258,639,793,820,818,826,835,833,828,824,830,832,837,832,842,857,872,894,898,891,879,881,852,839,819,821,812,807,799,799,793,788,778,794,785,791,807,818,816,815,800,804,794,767,421,301,286,307,291,283,275,275,276,273,276,274,266,266,255,255,245,245,237,238,240,242,226,227,223,223,217,213,205,220,220,214,123,133,126],
[119,110,120,116,132,130,130,111,124,130,130,115,121,128,134,122,131,131,136,134,134,123,137,132,134,128,137,125,132,132,138,139,136,132,142,134,138,131,149,145,154,147,139,151,150,146,149,143,141,146,263,297,305,300,318,315,313,308,310,311,313,299,319,318,315,313,321,321,330,320,325,312,318,306,313,301,311,304,307,307,305,293,310,306,307,301,308,311,310,304,313,295,302,190,152,147,156,154,147,144,147,143,146,138,139,141,141,144,138,129,133,129,144,138,131,137,133,132,128,118,131,127,126,122,135,214,226,219],
[196,196,203,199,209,212,222,219,221,217,226,227,235,219,228,230,243,233,244,231,242,241,245,236,254,240,251,249,260,250,263,255,261,262,272,267,265,264,268,272,273,273,284,286,283,283,293,268,242,248,651,801,823,818,809,824,836,822,819,825,815,828,826,832,840,857,886,880,879,881,868,834,821,801,812,806,794,787,793,791,786,771,783,794,790,803,801,808,812,794,803,799,768,438,315,291,293,295,294,287,283,276,276,272,272,261,265,262,263,255,249,248,254,233,235,232,236,230,223,213,213,210,219,216,209,214,226,219],
[196,196,203,199,209,212,222,219,221,217,226,227,235,219,228,230,243,233,244,231,242,241,245,236,254,240,251,249,260,250,263,255,261,262,272,267,265,264,268,272,273,273,284,286,283,283,293,268,242,248,651,795,825,820,822,819,825,813,822,824,808,824,826,838,843,867,881,888,890,883,881,845,836,810,819,799,793,790,790,787,769,765,780,784,786,797,801,812,810,787,797,793,772,438,315,283,308,300,294,279,269,269,276,276,275,251,260,262,250,249,237,252,247,227,241,229,234,226,223,211,217,214,214,209,219,224,228,218],
[204,198,209,200,210,201,213,215,214,219,224,228,226,227,237,237,240,230,237,233,246,242,243,245,252,252,254,249,249,253,262,258,251,249,260,254,267,271,269,268,282,275,289,293,294,290,299,271,244,263,658,795,825,820,822,819,825,813,822,824,808,824,826,844,854,867,888,889,896,878,867,841,828,806,819,799,797,791,790,784,785,772,784,786,787,793,804,816,816,797,804,800,770,427,303,288,295,299,291,281,293,282,282,275,273,266,266,255,253,250,246,242,235,225,234,226,227,217,217,214,222,216,209,214,222,219,225,228],
[193,193,204,214,211,207,220,218,217,224,224,219,233,224,240,227,241,246,242,234,241,237,252,246,249,241,253,254,254,243,249,252,254,259,264,260,266,263,267,265,268,274,282,277,292,292,298,266,243,261,652,794,819,809,818,830,842,819,825,836,819,832,832,844,854,867,888,889,896,878,867,841,828,806,819,799,797,791,790,784,785,772,784,786,787,793,804,816,816,797,804,800,770,427,303,288,295,299,291,281,293,282,282,275,273,266,266,255,253,250,246,242,235,225,234,226,231,230,230,214,219,217,209,217,225,226,226,218],
[204,198,200,201,212,214,215,211,220,226,231,218,223,221,232,231,236,240,243,235,243,243,248,247,246,252,254,251,251,251,259,257,264,257,268,263,274,272,272,273,281,277,288,288,290,290,298,267,243,253,653,789,821,816,818,823,835,819,827,825,817,833,831,839,850,863,887,881,889,881,877,843,834,810,818,810,799,795,785,789,789,772,790,778,779,795,808,797,800,781,796,791,763,427,305,283,305,293,294,278,286,274,275,273,269,261,263,260,262,254,254,243,248,239,237,233,231,230,230,214,219,217,209,217,225,226,226,218],
[204,195,206,199,216,212,228,212,214,215,216,217,231,224,244,240,231,231,235,227,239,236,238,246,242,239,251,244,256,254,263,258,259,251,265,265,279,278,274,278,287,265,283,288,293,292,298,274,243,251,649,793,820,814,826,826,827,819,821,825,823,834,836,838,848,867,883,879,893,886,880,842,827,808,815,801,801,796,791,791,787,767,781,782,780,796,803,803,808,789,801,790,770,438,307,283,297,299,289,281,284,278,274,272,267,259,265,256,258,254,254,243,251,237,237,233,236,230,227,219,755,748,745,746,757,767,785,792],
[173,170,182,171,179,185,182,182,185,197,198,190,203,196,198,198,201,205,214,208,211,200,224,214,211,211,220,212,222,211,217,220,230,227,227,225,236,240,234,235,245,237,246,243,255,248,260,240,219,217,525,636,658,650,653,664,668,654,659,660,660,666,664,669,685,700,714,712,713,700,706,679,667,648,658,647,640,633,639,640,634,619,633,636,638,650,651,643,648,636,646,632,608,348,258,235,251,237,252,242,235,237,240,230,227,227,229,224,222,209,213,212,214,202,209,201,204,199,202,195,193,208,207,217,220,220,226,223],
[201,190,208,202,216,209,224,214,222,211,235,232,236,231,233,225,237,234,234,231,241,236,250,242,254,243,245,239,253,250,258,251,255,253,260,272,266,274,275,265,281,277,288,290,290,283,281,271,238,260,662,802,827,819,813,836,830,830,826,827,817,825,836,842,856,865,876,886,904,889,881,844,842,809,824,808,803,793,783,780,779,761,788,792,779,803,813,806,806,787,795,785,768,436,315,291,293,288,283,280,281,260,274,266,275,261,268,260,262,251,249,243,245,232,242,234,223,225,228,214,214,208,207,217,220,220,226,223],
[201,190,208,202,216,209,224,214,222,211,235,232,236,231,233,225,237,234,234,231,241,236,250,242,254,243,245,239,253,250,258,251,255,253,260,272,266,274,275,265,281,277,288,290,290,283,281,271,238,260,656,785,817,812,814,835,825,809,820,826,818,827,833,832,853,870,890,891,905,889,871,854,824,803,809,804,804,786,794,789,788,776,788,794,789,809,801,801,807,790,799,787,761,428,308,279,297,288,292,286,283,267,269,271,274,266,266,255,249,244,246,242,242,235,233,228,230,222,219,217,225,212,214,214,214,203,217,224],
[192,194,202,209,205,195,213,212,230,226,219,219,229,230,230,230,235,235,233,228,238,234,240,233,233,237,256,243,249,239,252,244,262,259,264,265,276,268,274,278,271,281,294,290,298,296,293,268,246,254,656,785,817,812,814,835,825,809,820,826,818,838,835,841,843,873,890,890,889,884,880,850,826,811,815,801,802,787,793,781,789,768,778,784,787,801,804,816,811,793,800,794,767,435,312,284,295,302,287,281,279,282,272,267,269,261,268,259,251,255,253,245,252,243,235,229,233,228,226,211,219,205,224,210,217,221,229,220],
[208,194,195,196,212,202,219,212,228,219,217,228,231,227,233,237,231,231,247,227,237,241,247,246,250,243,239,252,256,242,254,248,257,263,272,255,265,278,274,275,276,279,286,291,287,293,293,266,239,256,658,798,813,809,815,838,835,818,819,833,834,838,835,841,843,873,890,890,889,884,880,850,826,811,815,801,802,787,793,781,789,768,778,784,787,801,804,816,811,793,800,794,767,435,312,284,295,306,301,283,293,286,288,275,278,269,263,257,262,245,251,252,251,246,227,236,233,226,228,223,228,217,216,217,220,211,234,225],
[203,200,203,203,212,211,220,211,230,216,228,223,230,225,236,229,240,237,238,233,240,244,241,244,253,246,253,250,257,247,256,258,260,255,263,267,268,271,286,271,278,284,295,296,299,292,299,284,248,258,673,818,841,843,844,850,864,847,860,853,848,859,858,868,874,892,910,916,923,908,907,880,861,835,847,826,824,811,812,803,807,787,810,803,822,815,827,833,835,820,833,828,787,446,313,295,312,306,301,283,293,286,288,275,278,269,263,257,262,245,251,252,251,246,227,236,233,226,228,210,226,211,209,209,226,211,216,213],
[178,181,181,177,183,183,208,190,197,198,210,194,203,205,204,204,212,203,216,213,212,220,215,211,217,216,224,224,230,219,219,227,237,229,231,238,240,242,248,243,249,244,263,262,255,255,257,241,231,234,570,688,707,699,705,711,722,710,711,715,712,709,711,724,734,746,757,756,768,760,756,707,707,693,693,690,690,675,675,673,668,663,678,670,667,683,693,686,700,688,690,681,657,380,284,260,274,263,259,251,256,248,252,246,243,235,233,232,230,253,244,246,242,227,244,224,240,227,216,221,214,210,211,211,207,216,230,219],
[192,194,202,200,206,208,219,218,227,213,230,224,235,221,229,242,230,241,247,228,250,234,243,237,244,244,246,242,246,249,260,244,262,255,253,265,260,274,278,275,275,269,280,288,287,285,295,276,243,249,664,800,826,822,827,837,842,822,841,832,840,838,843,857,853,868,896,898,907,888,884,854,848,818,827,809,804,800,796,798,779,773,780,790,787,797,812,806,810,789,801,793,768,426,305,281,294,290,282,280,281,270,278,264,261,264,268,251,255,253,244,246,242,227,244,224,240,227,216,221,214,210,211,211,207,216,230,219],
[192,194,202,200,206,208,219,218,227,213,230,224,235,221,229,242,230,241,247,228,250,234,243,237,244,244,246,242,246,249,260,244,256,258,261,261,266,263,275,265,285,282,283,283,284,290,299,265,248,260,654,803,823,821,830,843,840,819,833,836,830,834,834,835,857,869,894,887,899,893,878,852,848,814,815,809,806,802,799,797,781,772,790,784,785,805,812,806,818,803,813,800,774,438,312,279,300,287,291,281,277,282,278,267,273,262,262,251,251,249,249,250,254,233,233,231,230,233,219,217,226,203,217,205,220,228,222,219],
[204,198,205,201,208,205,220,210,223,225,224,219,234,219,225,240,244,234,241,227,248,237,242,244,248,235,239,237,250,249,257,261,256,258,261,261,266,263,275,265,285,282,283,283,284,295,304,269,245,260,662,799,824,824,816,838,843,827,833,829,830,838,835,845,860,870,890,891,891,889,884,850,838,805,821,805,816,802,794,785,790,784,786,795,781,806,818,816,817,801,816,806,778,435,313,290,299,297,293,288,291,282,275,269,264,251,265,256,262,255,241,237,253,234,243,229,228,226,223,217,221,213,226,211,219,221,230,218],
[192,203,200,198,214,203,213,220,220,211,229,225,237,219,227,225,239,230,246,232,241,237,244,250,235,248,251,240,247,243,259,255,261,252,262,254,257,273,276,282,283,275,285,281,300,295,304,269,245,260,662,799,824,824,816,838,843,827,833,829,830,838,835,845,860,870,890,891,891,889,884,871,864,827,838,827,830,813,818,813,811,788,803,816,809,820,841,834,828,811,833,817,790,431,315,289,302,297,298,284,295,268,275,276,275,269,267,264,259,254,249,250,245,242,241,235,232,223,230,217,222,217,227,220,219,224,232,224],
[205,203,205,214,225,208,220,222,224,226,224,231,233,234,245,240,236,232,244,237,247,249,246,237,247,252,250,246,259,254,249,256,264,254,265,262,276,281,288,280,288,285,294,289,291,297,305,268,251,262,673,818,841,850,845,859,858,833,848,853,850,864,867,864,881,898,917,918,917,912,900,871,864,827,838,827,830,813,818,813,811,788,803,816,809,820,841,834,828,811,833,817,790,431,315,289,302,297,298,284,295,268,275,261,261,254,262,246,251,243,243,233,241,229,232,230,234,222,219,203,217,212,218,214,222,218,227,219],
[178,186,192,183,190,198,208,203,198,203,211,209,211,201,209,207,220,215,220,212,213,212,226,214,222,230,234,234,240,222,234,235,240,235,243,241,249,251,249,249,255,255,265,253,261,257,261,241,217,225,584,687,721,716,719,726,740,726,730,732,732,738,738,746,752,762,784,778,786,778,774,743,734,714,723,699,705,695,697,691,685,673,685,687,687,700,709,709,708,690,705,802,771,427,307,281,303,289,285,281,285,276,279,276,276,268,266,260,252,246,246,242,240,234,232,222,232,219,211,195,209,205,213,215,212,220,228,228],
[198,202,201,205,217,209,217,221,213,220,230,219,237,221,237,228,242,242,246,246,247,243,251,246,251,250,250,235,241,235,257,248,249,249,256,265,268,272,274,278,282,275,294,290,291,291,299,274,251,251,657,801,825,817,821,837,845,829,838,845,842,848,848,854,866,871,898,900,899,898,889,851,835,809,824,808,805,797,793,800,788,778,786,802,798,806,816,810,818,799,811,802,771,427,307,281,303,289,285,281,285,276,279,276,276,268,266,260,252,246,246,242,240,234,232,222,232,219,211,195,209,205,213,215,212,220,228,228],
[198,202,201,205,217,209,217,221,213,220,230,219,237,221,237,228,242,242,246,246,233,233,243,239,239,244,256,246,262,246,258,251,259,259,264,264,269,273,273,269,281,284,292,290,294,294,306,274,250,259,659,803,819,817,823,832,844,834,842,838,834,842,842,851,858,871,883,881,905,889,888,849,844,817,831,816,812,806,802,798,791,779,794,794,793,799,813,811,815,804,812,796,768,426,306,291,298,291,283,275,281,269,280,269,265,261,260,263,262,250,247,242,251,242,240,235,232,227,225,217,224,217,224,224,224,226,231,230],
[196,201,213,200,214,204,210,222,217,212,217,228,239,222,242,240,240,235,239,229,233,233,243,239,239,244,256,246,262,246,258,258,262,258,258,270,263,267,273,273,277,280,292,288,294,294,298,274,250,259,659,803,827,825,825,837,846,836,842,846,838,842,843,841,856,873,900,895,900,890,882,851,835,816,819,803,803,805,795,796,789,777,790,796,802,806,818,818,819,799,809,803,773,436,318,294,306,304,298,283,286,263,267,259,261,257,256,260,260,240,252,244,254,240,231,225,237,217,230,217,226,215,218,210,223,219,219,211],
[191,194,206,210,210,201,211,205,228,216,226,220,223,227,233,229,233,228,240,244,243,235,243,235,243,245,249,245,256,244,262,258,262,258,258,270,263,267,273,273,277,280,292,288,294,291,297,273,248,262,662,804,834,819,823,833,837,825,836,842,834,848,842,843,857,875,897,889,905,887,887,854,843,818,827,811,803,797,797,797,782,782,794,794,795,810,815,813,815,797,813,807,774,430,306,280,299,293,289,276,284,272,278,274,267,258,259,251,261,249,249,241,252,238,240,234,235,227,223,217,224,215,220,220,226,226,230,223],
[197,198,211,201,213,213,220,220,226,226,231,226,235,223,227,237,244,234,246,240,242,235,251,248,253,241,245,244,260,242,258,251,255,251,265,265,269,265,272,278,286,278,290,283,287,291,297,273,248,262,662,804,834,819,823,833,837,825,836,842,834,848,842,843,857,875,897,889,905,887,887,854,843,818,827,811,803,797,797,797,782,782,794,794,795,810,815,813,815,797,813,807,774,430,306,280,299,293,289,276,284,275,277,268,276,266,272,251,259,251,251,245,247,244,242,234,240,227,223,213,213,214,214,211,219,216,225,221],
[187,177,194,185,203,187,200,198,215,187,206,203,219,206,214,214,223,221,224,218,227,227,225,217,236,230,227,219,237,230,240,231,243,241,252,242,254,255,257,260,281,272,291,289,288,286,297,265,240,251,649,789,816,814,811,836,846,819,837,850,834,841,852,854,851,876,906,891,899,892,883,851,839,812,825,805,805,794,799,797,800,771,793,790,800,809,805,806,814,793,812,806,767,429,324,294,293,288,286,278,277,270,278,275,273,262,255,253,260,254,241,236,238,243,229,230,238,225,229,226,216,217,212,211,215,220,222,216],
[192,198,208,212,214,211,217,213,228,214,227,216,242,234,225,242,238,227,239,228,243,239,244,246,242,249,239,246,255,245,253,254,255,249,260,258,257,264,282,280,281,272,291,289,288,286,297,265,240,251,649,789,816,814,811,836,846,819,837,850,834,841,852,854,851,876,906,891,899,892,883,851,839,812,825,805,805,794,799,797,800,771,793,790,800,809,805,806,814,793,812,806,771,426,313,281,297,289,297,284,278,266,280,274,265,265,265,258,260,258,254,250,243,240,233,233,237,231,230,224,222,214,215,216,221,217,225,224],
[208,193,205,203,201,205,214,219,227,221,230,214,235,231,229,225,233,236,238,230,246,242,251,243,235,243,253,245,253,244,258,258,259,259,259,257,265,269,273,278,288,274,286,287,297,289,293,272,244,258,651,794,822,817,817,829,835,829,839,836,830,842,843,851,863,865,895,893,904,887,892,855,848,822,826,811,811,803,801,800,791,768,784,795,783,797,809,809,812,798,806,802,771,426,313,281,297,289,297,284,278,266,280,274,276,264,264,259,261,252,252,246,246,240,235,233,229,221,220,212,230,220,203,217,225,224,228,228],
[204,202,198,210,211,205,209,224,228,215,221,228,226,234,233,237,244,228,242,233,235,241,245,241,240,246,254,246,251,235,253,253,256,256,262,266,275,267,275,265,273,269,279,292,294,291,298,275,249,257,653,802,830,823,826,839,843,832,833,844,845,848,848,842,851,867,888,889,893,884,885,842,842,810,817,808,809,804,796,794,790,775,783,789,793,805,816,806,816,798,810,799,771,433,313,292,310,298,298,283,283,277,277,270,276,264,264,259,261,252,252,246,246,240,235,233,229,221,220,212,230,220,203,217,225,224,228,228],
[204,202,198,210,211,205,209,224,228,215,221,228,226,234,233,237,244,228,242,233,235,241,245,241,240,246,254,246,251,235,253,253,256,256,262,266,265,268,276,268,279,274,283,281,283,284,300,278,246,251,655,797,820,822,826,838,843,823,833,839,842,850,848,855,863,879,901,895,902,900,886,851,845,812,836,814,806,803,795,789,785,776,788,790,798,807,809,811,811,797,812,806,775,434,315,287,307,300,294,288,286,275,275,275,269,268,262,262,259,251,255,243,248,238,234,233,229,225,224,220,222,214,211,211,217,217,228,228],
[204,202,204,206,209,201,212,214,219,209,217,220,226,219,249,236,234,238,234,227,241,235,249,236,246,250,251,250,255,237,256,256,262,255,265,255,265,268,276,268,279,274,283,281,283,284,300,278,246,251,652,790,827,813,813,838,848,830,833,843,829,852,852,854,866,882,895,897,902,886,890,847,840,821,830,818,803,795,789,792,790,774,786,786,801,803,809,812,818,795,811,799,771,433,318,290,307,297,291,273,289,279,278,275,274,259,265,253,262,246,251,245,245,239,242,240,227,223,223,217,212,215,222,219,216,209,220,230],
[156,155,166,170,165,164,182,170,179,169,180,182,189,180,194,183,187,185,188,183,194,186,193,193,199,198,198,194,201,201,212,210,218,203,217,209,220,218,222,218,223,219,225,224,226,227,233,205,196,202,478,579,595,597,590,606,603,605,600,604,604,614,618,617,621,623,644,643,651,645,639,608,598,592,595,579,585,582,582,571,579,559,566,570,571,577,585,590,592,578,578,573,549,326,254,234,229,229,229,228,230,215,216,224,224,210,211,203,209,204,208,190,202,185,196,196,198,187,193,173,188,180,182,171,181,182,180,186],
]
cross2 = [
[379,315,232,196,195,201,207,207,212,210,218,211,217,214,219,217,217,225,228,230,234,232,229,230,238,238,235,248,241,237,247,254,251,249,252,252,222,267,257,265,276,266,275,269,276,274,278,275,281,268,244,272,563,731,749,748,766,762,767,783,788,787,803,803,821,820,838,834,821,825,815,808,795,779,773,750,762,755,753,767,756,766,771,773,781,788,758,640,391,273,277,292,298,287,280,280,278,267,267,261,256,260,255,253,249,247,254,250,249,233,237,236,240,230,227,213,215,212,218,203,203,204,206,195,193,642,639,656],
[360,308,230,185,182,182,197,199,209,198,206,199,202,201,210,203,212,210,219,220,219,215,214,216,228,217,228,240,233,234,241,236,240,233,244,241,220,258,248,250,251,246,255,265,262,259,263,267,265,258,232,256,530,689,710,704,722,723,725,742,745,748,758,761,774,771,791,779,781,784,771,759,747,743,726,705,720,715,716,722,715,727,731,737,742,747,716,601,372,268,267,272,275,269,268,264,272,254,261,266,249,252,243,247,246,233,231,235,229,228,217,228,216,215,218,211,214,209,205,195,195,197,194,189,190,185,188,186],
[360,308,230,185,182,182,197,199,209,198,206,199,202,201,213,213,224,226,226,219,219,221,225,228,230,228,234,240,235,233,245,237,246,246,247,247,219,255,253,261,262,260,263,266,267,259,271,271,277,262,240,272,554,723,737,737,749,749,758,767,778,775,793,793,800,807,816,816,811,810,795,787,776,768,762,743,743,745,741,751,748,756,759,767,763,767,745,625,380,276,274,286,287,283,269,271,269,269,268,266,258,251,249,249,245,244,244,240,240,231,227,217,233,220,224,219,215,209,205,201,201,198,198,190,187,187,187,193],
[366,312,238,190,190,188,214,205,210,217,212,214,214,210,213,213,224,226,226,219,219,221,225,228,230,228,234,240,244,243,243,237,249,252,252,254,230,255,259,265,261,260,276,276,278,279,281,280,284,272,235,267,559,729,756,757,768,763,775,789,783,785,800,810,810,823,827,825,821,825,820,803,791,779,771,745,753,756,758,762,760,765,772,776,786,785,761,637,388,278,274,287,287,281,269,284,276,276,272,255,265,260,257,256,258,251,241,239,245,239,240,231,231,219,217,217,215,212,215,203,202,195,197,196,198,194,193,193],
[380,311,234,196,194,195,200,205,212,215,215,213,213,224,220,222,227,219,225,228,228,227,227,231,225,233,237,244,244,243,243,237,249,252,252,254,230,255,259,265,261,260,276,276,278,279,281,280,284,272,235,267,559,729,756,757,768,763,775,789,783,785,800,810,810,823,827,825,821,825,820,803,791,779,771,745,753,756,758,762,760,765,772,776,786,786,770,641,393,278,279,285,285,288,278,263,269,268,278,274,257,260,256,250,255,245,246,246,227,237,236,230,230,226,222,217,217,214,220,211,201,205,197,198,199,194,189,197],
[377,313,236,190,195,193,201,206,212,208,211,212,220,222,219,217,228,226,227,221,229,226,223,225,237,231,246,233,245,240,243,251,252,252,254,251,219,257,257,263,272,266,267,267,271,276,278,282,283,267,237,269,561,742,754,759,765,757,772,784,786,787,799,805,809,828,830,838,830,826,817,804,790,786,771,747,759,749,757,766,758,763,765,777,781,786,770,641,393,278,279,285,285,288,278,263,279,268,274,267,260,260,260,250,250,245,249,249,246,240,232,228,238,219,227,221,217,212,215,195,204,204,198,187,195,193,196,191],
[381,323,234,195,193,199,214,210,208,207,212,212,215,214,218,216,221,228,230,222,229,229,228,230,242,234,235,236,241,244,246,243,249,253,253,258,222,257,257,262,274,267,264,261,277,272,284,283,289,265,237,270,562,735,751,753,768,764,770,777,781,781,800,814,818,819,825,825,823,826,826,809,795,786,774,749,753,753,759,774,760,769,772,778,779,789,764,646,393,269,269,292,290,291,273,277,279,268,274,267,260,260,260,250,986,968,966,936,928,905,876,851,848,841,820,808,783,774,761,738,721,703,680,662,658,668,658,673],
[292,246,187,153,156,166,159,172,180,176,176,176,180,182,182,182,179,179,185,181,190,183,179,177,196,190,198,195,193,198,198,198,202,200,201,205,188,210,211,209,220,212,218,211,211,221,224,228,226,215,189,214,420,550,553,545,556,556,566,576,569,569,590,594,595,595,601,608,604,595,591,581,573,580,566,550,552,553,557,562,562,563,569,572,574,574,558,479,301,224,224,231,232,298,281,282,285,274,269,272,269,259,256,254,260,251,252,251,249,242,238,227,229,227,228,226,220,216,224,211,213,208,197,195,201,194,204,194],
[380,317,247,201,196,195,208,216,215,211,215,219,215,221,228,218,221,222,225,230,233,234,225,234,239,236,241,250,245,246,251,252,253,262,253,258,233,270,257,274,269,266,268,278,281,278,281,283,285,278,237,274,573,754,773,772,781,786,785,802,801,806,815,822,833,838,845,846,844,854,832,818,808,806,781,770,773,778,769,786,772,794,789,802,797,810,777,660,397,290,280,291,297,298,281,282,285,274,269,272,269,259,256,254,260,251,252,251,249,242,238,227,229,227,228,226,220,216,224,211,213,208,197,195,201,194,189,196],
[369,305,229,182,194,195,197,205,214,211,207,203,218,211,211,209,224,214,222,219,227,228,226,231,233,236,234,234,237,239,244,246,250,251,253,252,228,255,259,261,260,262,258,265,265,268,274,273,277,265,236,272,551,713,733,729,740,735,747,760,765,762,771,779,781,804,802,798,791,801,796,784,766,755,745,727,740,730,731,741,733,746,754,759,753,764,742,624,379,265,269,284,286,282,269,273,272,263,266,259,257,256,258,250,249,241,244,246,240,235,225,220,226,222,217,209,209,210,218,203,197,196,204,186,193,189,189,196],
[369,305,229,182,194,195,197,205,214,214,209,209,226,217,217,213,220,219,219,219,233,236,223,225,229,231,238,235,243,244,244,242,249,249,252,258,231,255,257,268,274,264,269,271,278,274,275,273,288,272,243,273,565,736,754,752,761,765,774,786,785,783,801,812,818,817,825,829,822,822,813,801,794,778,765,751,756,763,763,761,756,768,777,776,781,780,763,643,385,280,278,291,291,283,276,279,282,267,269,268,263,259,255,253,252,254,249,241,248,242,240,232,236,230,226,222,217,212,215,212,210,197,193,198,194,193,193,197],
[380,318,242,196,198,195,219,209,212,214,209,209,226,217,217,213,220,219,219,219,233,236,223,225,229,231,238,235,243,244,244,242,249,249,252,258,231,255,257,268,274,264,269,271,278,274,275,273,288,272,243,273,565,736,754,752,761,765,774,786,785,783,801,812,812,820,830,823,819,823,815,800,789,780,767,747,755,749,757,768,758,766,771,777,777,781,761,636,390,278,269,292,292,291,272,281,271,265,268,268,263,255,255,253,253,248,252,246,247,235,229,229,236,224,226,219,211,211,209,204,204,202,195,195,179,187,189,196],
[378,319,235,193,193,198,208,211,207,206,222,218,216,211,216,224,226,222,219,219,233,228,229,230,236,234,237,235,244,240,246,242,251,249,249,252,228,262,255,259,275,265,271,272,278,279,283,275,281,265,236,274,567,735,747,747,761,761,772,786,787,783,797,804,812,820,830,823,819,823,815,800,789,780,774,754,756,755,759,764,768,770,773,777,788,784,763,643,381,271,273,290,282,290,276,284,282,274,269,265,262,262,259,255,252,252,251,243,239,242,242,223,229,229,224,218,219,212,216,212,211,201,197,189,198,187,192,196],
[267,228,173,147,153,148,164,154,158,162,158,159,169,153,161,164,161,164,167,166,178,171,163,167,169,173,177,173,175,173,183,188,188,182,186,184,169,185,189,193,189,190,199,198,199,195,208,203,195,195,173,197,373,480,488,484,496,487,499,499,499,489,505,509,517,517,524,524,524,518,519,507,513,493,493,481,485,485,490,494,490,494,496,503,499,505,489,421,269,205,205,208,212,212,199,210,203,195,195,193,193,185,189,189,183,182,186,178,182,179,176,168,177,173,173,165,172,167,166,166,158,158,158,153,153,141,153,156],
[267,228,173,147,153,148,164,154,158,162,158,159,169,153,161,164,161,164,167,166,178,171,163,167,169,173,177,173,175,173,183,188,188,182,186,184,169,185,189,193,189,190,274,267,270,277,280,272,290,270,240,274,563,735,749,745,761,757,775,784,790,786,798,803,817,817,825,825,823,828,816,802,790,779,767,747,755,753,757,765,758,766,778,778,779,787,761,637,391,279,276,286,287,283,273,273,269,269,269,262,260,262,259,255,254,249,249,245,245,237,240,228,236,230,223,215,213,207,207,201,204,198,198,191,190,195,192,189],
[374,313,236,190,196,193,209,212,216,220,214,214,216,209,217,217,225,224,228,226,226,226,227,235,233,233,239,245,244,246,246,250,251,249,249,255,225,261,260,260,266,270,274,267,270,277,280,272,290,270,240,274,563,735,749,753,764,764,772,775,786,783,793,801,812,817,828,823,822,823,811,795,783,773,768,756,758,754,761,763,757,768,777,780,786,790,762,641,385,271,276,288,294,288,274,286,275,257,269,269,261,263,258,255,251,247,249,243,237,236,236,226,226,223,218,219,211,213,220,204,208,195,199,193,189,193,197,194],
[372,316,239,188,189,204,211,213,212,211,211,216,216,217,218,224,223,225,221,220,228,226,226,227,227,227,235,233,237,244,246,247,250,251,251,249,225,260,257,263,266,266,267,265,273,271,277,277,284,272,242,274,563,739,751,753,764,764,772,775,786,783,793,801,812,817,828,823,822,823,811,795,783,773,768,756,758,754,761,763,757,768,778,777,784,792,764,642,385,282,269,288,283,292,274,277,278,271,272,255,268,259,256,251,249,254,241,242,245,236,233,224,234,221,220,214,225,214,205,204,203,201,203,196,202,193,194,193],
[376,321,234,193,188,194,204,208,207,212,217,218,217,224,223,217,222,219,224,219,230,223,220,234,239,236,237,244,243,237,247,248,254,249,254,254,228,263,257,262,265,270,275,269,274,277,282,285,290,271,238,273,557,743,751,762,765,768,771,776,779,789,799,808,823,821,830,825,828,819,813,802,792,782,767,764,761,760,762,768,770,773,778,777,784,792,764,642,385,282,269,288,283,292,274,277,278,271,272,255,268,259,256,251,249,254,241,242,245,236,233,224,234,221,224,224,215,211,216,205,205,204,194,190,187,185,189,183],
[372,318,235,185,185,198,210,203,205,212,210,211,212,214,218,218,220,228,228,223,219,225,221,236,230,234,234,239,241,238,246,246,247,251,248,247,228,259,259,265,261,261,266,268,274,267,277,273,284,268,240,272,561,727,745,741,764,758,763,767,777,769,789,796,807,811,819,821,809,821,804,794,779,767,761,748,758,758,754,761,753,765,772,775,775,779,755,633,385,271,274,294,287,285,269,276,274,266,267,261,268,256,254,251,249,245,245,237,244,238,234,223,225,221,224,224,215,211,216,205,205,204,194,190,187,185,189,198],
[379,320,233,196,198,195,204,213,215,208,211,207,213,214,220,219,223,220,229,230,234,227,225,228,230,242,235,237,238,244,254,243,249,252,258,258,222,255,260,268,274,267,271,271,276,278,295,281,284,270,242,283,569,736,756,758,763,765,772,780,786,786,797,812,820,816,829,825,828,830,822,798,785,780,770,755,763,753,758,766,759,773,773,786,786,786,763,648,389,278,274,283,291,281,277,278,275,269,265,274,268,259,251,253,257,252,254,242,248,239,236,222,235,227,225,221,215,214,219,205,204,200,204,187,187,193,199,198],
[379,320,233,196,198,195,204,213,215,208,211,207,213,214,220,219,223,220,229,230,234,227,225,228,230,242,235,237,238,244,254,243,249,252,258,258,222,255,260,268,274,267,271,271,276,278,295,281,284,270,242,283,569,733,756,748,766,759,767,781,783,784,792,803,812,818,834,833,829,821,820,795,787,777,777,758,760,755,760,768,243,241,243,245,245,245,245,215,158,130,129,133,129,129,134,132,134,128,129,125,129,125,126,128,128,119,121,113,121,117,119,118,118,115,115,109,116,118,119,110,113,107,105,105,109,108,114,106],
[151,131,117,102,118,118,107,105,109,112,115,114,107,113,109,108,114,112,118,113,113,113,117,110,118,118,119,115,129,117,117,117,124,122,122,119,115,121,125,121,124,124,128,123,123,121,133,132,134,124,118,126,197,237,231,238,242,242,243,239,245,245,245,250,254,254,255,259,255,252,253,250,254,250,251,233,245,245,244,242,243,241,243,245,245,245,245,215,158,130,129,133,129,129,134,132,134,128,129,125,129,125,126,128,128,119,121,113,121,117,119,118,118,115,115,215,214,205,205,214,210,202,193,193,193,189,196,194],
[370,318,235,196,187,193,204,212,211,205,209,220,222,214,223,221,224,222,223,227,227,221,225,228,236,231,241,233,241,237,244,244,247,247,243,249,225,268,260,262,267,259,265,269,273,270,279,279,283,265,236,276,566,739,753,745,765,757,772,782,784,777,795,797,813,817,826,823,823,813,809,805,790,778,775,750,763,751,759,772,762,767,777,777,781,788,766,646,394,273,269,289,288,292,278,282,273,269,268,272,262,255,251,253,253,253,244,247,247,241,233,221,236,224,222,215,214,205,205,214,210,202,193,193,193,189,196,194],
[371,310,230,195,186,196,201,209,220,215,210,218,223,213,224,222,219,229,221,224,234,227,224,228,231,234,243,233,252,242,243,237,247,252,251,257,221,263,262,263,268,271,270,264,275,265,278,286,283,265,247,276,560,737,745,748,770,755,764,780,784,775,787,805,816,822,826,827,821,825,816,806,791,779,769,749,759,758,762,769,764,772,784,779,781,793,772,642,395,273,277,292,294,294,278,285,280,269,278,278,262,261,253,252,258,246,245,239,240,234,231,223,233,224,228,218,221,212,216,214,203,203,193,192,196,194,194,195],
[371,310,230,195,186,196,201,209,220,215,210,218,223,213,224,222,219,229,221,224,234,227,224,228,231,234,243,233,252,242,243,237,247,252,251,257,221,263,262,263,268,271,270,264,275,265,278,286,283,265,247,276,560,737,745,749,759,766,767,779,784,778,799,803,813,816,826,827,821,825,815,806,794,779,776,760,764,759,761,768,770,771,776,788,786,790,759,637,389,284,278,283,289,290,274,278,269,265,276,276,263,251,251,249,249,247,254,243,249,232,230,227,221,225,226,220,211,207,217,205,210,203,200,190,190,190,190,193],
[376,313,244,191,190,193,208,210,217,205,205,212,222,214,216,217,225,228,230,223,225,225,236,236,234,227,235,248,246,243,248,245,250,258,250,249,226,266,257,265,263,262,267,267,275,269,284,278,294,267,235,277,569,738,747,749,759,766,767,779,784,778,799,803,813,816,826,827,824,825,816,800,786,776,773,758,758,763,761,764,759,774,778,779,780,792,766,646,395,273,276,288,286,283,269,277,276,272,272,259,261,262,256,255,251,249,252,247,246,235,233,225,231,227,227,217,220,214,218,203,201,201,197,196,203,193,193,190],
[384,320,233,196,198,201,207,205,214,203,217,214,215,214,219,213,217,224,230,227,232,228,230,231,234,233,237,239,250,243,243,241,249,252,254,255,223,257,263,263,272,265,264,268,278,275,281,284,290,273,241,273,564,738,753,748,759,755,763,773,780,778,793,805,817,816,834,827,824,825,816,800,786,776,773,758,758,763,761,764,759,774,774,787,783,789,772,646,387,273,277,290,286,283,271,288,276,275,265,265,268,262,259,247,253,247,247,243,241,239,240,232,233,225,225,220,218,217,213,204,204,195,195,192,196,194,194,195],
[373,312,234,187,188,208,214,207,217,212,215,218,219,213,222,219,219,221,228,226,227,219,225,236,234,235,237,237,247,246,249,249,253,256,255,255,225,265,263,267,262,261,268,276,274,267,273,277,284,274,239,269,561,738,752,747,765,764,766,775,779,781,796,802,811,817,829,828,820,823,813,800,790,786,771,749,756,758,761,763,761,772,774,787,783,789,772,646,387,273,277,290,286,283,271,288,276,275,265,265,268,262,259,247,253,247,247,243,241,239,240,232,233,225,225,220,218,217,213,204,204,195,195,192,196,194,194,195],
[368,310,230,189,188,190,199,202,209,201,214,211,205,213,215,219,217,217,221,220,226,223,223,227,229,231,238,242,242,241,237,241,247,250,249,249,217,260,254,262,255,259,265,261,272,274,275,273,275,261,230,263,554,720,721,729,742,742,754,755,755,759,786,784,792,804,806,803,799,803,793,781,772,759,754,731,737,737,740,758,750,752,755,757,772,772,746,625,381,278,275,287,283,284,268,276,274,266,265,265,253,252,254,246,248,249,245,244,242,243,229,224,228,222,219,220,214,208,210,200,205,199,194,187,197,196,196,190],
[371,312,229,198,198,200,201,212,210,218,216,205,212,222,215,219,217,219,224,226,227,225,225,230,231,235,239,245,245,244,250,243,245,254,258,251,232,261,266,262,267,261,276,278,273,275,281,284,292,266,235,267,561,732,754,754,763,756,772,780,782,781,793,801,812,822,833,832,830,830,811,803,789,777,780,762,763,756,762,774,763,773,773,786,786,792,761,644,394,273,269,284,288,286,273,281,281,276,276,274,258,257,257,252,252,251,243,235,243,237,236,232,227,221,217,213,224,215,218,201,204,202,192,197,188,196,196,190],
[371,312,229,198,198,200,201,212,210,218,216,205,212,222,215,219,217,219,224,226,227,225,225,230,231,235,239,245,245,244,250,243,245,254,258,251,232,261,266,262,267,261,276,269,284,281,288,289,294,273,246,281,579,756,767,768,779,782,785,802,799,804,817,832,841,844,851,852,841,852,835,828,817,804,795,774,776,778,785,794,781,802,803,803,808,818,788,663,400,277,284,285,294,285,278,281,286,271,274,271,274,261,262,261,262,256,248,257,243,244,233,238,232,238,225,220,217,222,220,210,205,210,196,195,204,195,196,193],
[379,324,235,201,195,204,206,213,218,212,216,215,221,215,229,224,221,224,227,230,232,234,225,234,239,243,241,251,247,250,252,250,260,259,268,265,230,267,272,267,272,269,274,269,284,281,288,289,294,273,246,281,579,756,728,721,737,727,740,753,749,751,772,778,787,785,800,802,799,793,781,774,766,762,741,724,736,734,734,737,741,756,759,751,757,764,734,617,376,272,274,282,280,276,268,270,269,268,272,270,264,249,260,256,246,237,239,237,236,235,227,224,228,222,219,212,212,208,203,205,204,190,190,190,189,188,194,195],
[359,303,227,197,194,191,199,201,204,208,203,201,212,214,218,217,217,217,220,219,227,221,224,224,231,233,233,239,244,234,241,237,252,246,246,248,216,256,258,251,255,257,260,262,267,265,277,279,279,267,233,265,548,714,728,721,737,727,740,753,749,751,772,778,807,813,828,831,826,825,813,807,795,783,773,756,758,758,765,772,768,782,778,785,790,791,774,643,389,284,274,289,292,290,279,281,277,270,274,273,265,253,260,259,249,249,247,246,243,237,231,228,227,219,224,214,214,209,207,204,203,195,193,188,194,187,193,189],
[378,310,244,190,185,204,212,214,211,204,212,218,211,220,219,215,217,224,228,219,227,228,228,230,227,229,236,242,243,237,244,246,251,249,249,256,230,259,261,261,268,263,267,265,265,272,279,273,281,272,243,273,561,736,752,753,761,756,768,779,779,777,797,802,807,813,828,831,826,825,813,807,795,783,773,756,758,758,765,772,768,782,778,785,790,791,774,643,389,284,274,289,292,290,279,281,277,270,274,273,265,253,260,259,249,249,247,246,243,237,231,228,227,219,224,214,214,209,207,204,201,201,197,189,193,185,189,197],
]



ccd_data1 = ccd_data2 = originalCcdData1 = originalCcdData2 = [0] * 128
crossFlag = 0
width1 = width2 = 0
searchMidline2 = searchMidline1 = 64
searchFlag1 = searchFlag2 = 0
longNumber = 0
ccd_diff1 = ccd_diff2 = [0] * 128
max_peak1 = max_peak2 = 0
left_last_find1 = left_last_find2 = 1
right_last_find1 = right_last_find2 = last_left = last_right = 0
rising_edge_cnt = falling_edge_cnt = [0] * 5
rising_edge = falling_edge = 0
left_last_find = right_last_find = 0
left = right = 64
road_type = 0
threshold = 80

def plot_ccd_diff_with_edges(name, ccd_diff, left, right, middle,ccd = [0]*128):
    plt.figure(figsize=(12, 6))
    plt.plot(ccd_diff, label='CCD Diff', color='gray')
    plt.plot(ccd, label='CCD', color='red')
    plt.axvline(x=left, color='blue', linestyle='--', label=f'Left Edge: {left}')
    plt.axvline(x=right, color='blue', linestyle='--', label=f'Right Edge: {right}')
    plt.axvline(x=middle, color='green', linestyle='-', label=f'Middle: {middle}')


    # 设置图例
    plt.legend()
    plt.xlabel('Pixel Index')
    plt.ylabel('CCD Diff Value')
    plt.title(name)
    plt.grid(True)
    plt.show()


for ccd1 in cross2:
    max_peak1 = 0
    ccd_diff1 = [0] * 128
    for i in range(3, 128):  # 求出最大的差分值
        ccd_diff1[i] = ccd1[i] - ccd1[i - 3]
        if abs(ccd_diff1[i]) > max_peak1:
            max_peak1 = abs(ccd_diff1[i])

    diffLeft,diffRight,diffMiddle,rising_edge_cnt,falling_edge_cnt,rising_edge,falling_edge=find_road_edges_diff(ccd_diff1, threshold=150, last_middle_position=None)

    ccd = read_ccd_data(ccd1, ccd1, 480, 480, 0)[0]
    left, right, middle = find_road_edges(ccd,0, 1)
    width1 = diffRight - diffLeft
    width2 = right - left

    plusLeft, plusRight, left_last_find, right_last_find, reference_width, road_type = normal(
        ccd1, left_last_find, right_last_find, rising_edge_cnt, falling_edge_cnt,
        rising_edge, falling_edge, road_type, last_left, last_right, ccd_diff1, threshold)

    plot_ccd_diff_with_edges("ORIGION", ccd_diff1, left, right, middle, ccd1)
    """
    plot_ccd_diff_with_edges("DIFF", ccd_diff1, plusLeft, plusRight, 0.5 * (plusLeft + plusRight) + 1, ccd1)
    
    plot_ccd_diff_with_edges("DIFF", ccd_diff1, diffLeft, diffRight, diffMiddle, ccd1)
    plot_ccd_diff_with_edges("ORIGION", ccd_diff1, left, right, middle, ccd1)
   
    print(f"diff : left:{diffLeft},right:{diffRight},middle:{diffMiddle},width:{width1}")
    print(f"orig : left:{left},right:{right},middle:{middle},width:{width2}")



    print(f"normal : left:{normalLeft},right:{normalRight},middle:{normalMiddle},width:{normalRight - normalLeft}")
    plusLeft, plusRight, left_last_find, right_last_find, reference_width, road_type = normal(
        ccd1, left_last_find, right_last_find, rising_edge_cnt, falling_edge_cnt,
        rising_edge, falling_edge, road_type, last_left, last_right, ccd_diff1, threshold)

    print(f"plus : left:{plusLeft},right:{plusRight},middle:{0.5 * (right + left) + 1},width:{reference_width}")
    print("")
    """
    last_left = left
    last_right = right
